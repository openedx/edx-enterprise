# Config file for automatic testing at travis-ci.org

language: python

python:
  - 2.7
  - 3.5

env:
  - TOXENV=django18
  - TOXENV=django19

matrix:
  include:
    - python: 3.5
      env: TOXENV=quality
    - python: 2.7
      env: TOXENV=quality
    - python: 3.5
      env: TOXENV=docs
    - python: 2.7
      env:
        - TOXENV=jasmine
      before_script:
        - "export DISPLAY=:99.0"
        - "sh -e /etc/init.d/xvfb start"
        - sleep 3 # give xvfb some time to start
      addons:
        firefox: "45.0"
    - python: 2.7
      env:
        - RUNJSHINT=true

cache:
  - pip

install:
  - pip install -r requirements/travis.txt

script:
  - if env | grep RUNJSHINT; then make jshint; else tox; fi

after_success:
  - codecov

# Set password via "travis encrypt --add deploy.password"; for details, see
# https://docs.travis-ci.com/user/deployment/pypi
deploy:
  provider: pypi
  user: edx
  distributions: sdist bdist_wheel
  on:
    tags: true
    condition: '$TOXENV = quality'
  password:
    secure: MOCVq3PmcFGvcONcyeXroAuQBqwh6HydXmBUQwXgoF9TcvQ4WQYO8gdoiNS6opgP4L6Xz/X1nW9bvVPqGBP9r6HHxl+we1PX6IURC6N6KpRF0beJKUlsHyBFRPqLy+G0RSEcPIrRHAlwwlTFFj5RbhfZafjH3Z71KTXz8gvghkHM64g8ggWWqMDzrUwU/6orQxvpCxXwCh0GviIU86csw9yVb2pzdSb+dElQCn1xTmqgKPmUruRhEWitL7S4aYu3eEFTlkIcSARoeVY03THBLpcrI/mZRYGAtv4l8XlT2siy5hCHInNmin36InJdhbC25d1Zzr2d0zR7pbuQY3IIy+CxS/6pi9RcPm6/Vmjfr7jH9wO3XTNIer85pmjMyk8l+9yrpio1/WrliqaS6IxwObKAdxfW017pKC9/cCqX5ez1VIvklJJiYCSExvogvoswLQEW4aJjqoS8EdF+n8WNEHIRpx5o/bDoQUnqi7yejfdVDVq8UuqVPkdD5qIVIq8AOD0LikNyAy4f57rUHHbMzkhJ2LDZhK7InxJuLZT1VGMIXkUyIuC/BprSUb5n4AasrUZyJa2btaEDZLwRXRFzsUUCXRRqjXByz0BCUyR3ABm9v3JE8FTf2o+Tf6cqtdAWL1Fp/RPH+5P9Ub4yfOK2xOWeWHQ39YGUZz/q2tv83n8=
